{"version":3,"sources":["Footer.tsx","protocol.ts","tree/problem.ts","tree/filter.ts","tree/Context.ts","tree/images/add.svg","tree/images/edit.svg","tree/images/confirm.svg","tree/images/cancel.svg","tree/images/trash.svg","tree/images/copy.svg","tree/images/code.svg","tree/images/section.svg","tree/images/value.svg","tree/images/vscode.svg","tree/images/google-translate.svg","tree/images/deepl.svg","tree/components/Button.tsx","tree/components/Controls.tsx","tree/components/ControlsContainer.tsx","tree/util.ts","tree/components/TranslateButton.tsx","tree/components/SourceMatch.tsx","tree/ValueNode.tsx","tree/ObjectNode.tsx","tree/Tree.tsx","action.ts","parse.ts","App.tsx","index.tsx"],"names":["Footer","year","useMemo","Date","getFullYear","Container","ActionType","MatchType","NodeType","styled","div","Problem","NO_PROBLEM","extractPlaceholders","value","matches","match","Array","from","Set","map","p","substring","length","sort","findProblemsTraverse","node","languages","sourceMatches","report","type","VALUE","exactSourceMatches","filter","id","EXACT","partialSourceMatches","startsWith","some","l","undefined","values","MISSING","trim","EMPTY","foundSourceMatch","foundPartialSourceMatch","PARTIAL_MATCH_IN_SOURCES","NO_MATCH_IN_SOURCES","Object","v","index","sorted","SAME","DEFAULT","placeholders","all","isEqual","PLACEHOLDER_MISMATCH","OBJECT","children","forEach","n","findProblems","problems","problem","push","findFilteredIDsTraverse","caseSensitive","isMatch","includes","toLowerCase","findFilteredIDs","ids","findIDsTraverse","findIDs","TreeContext","React","createContext","Button","onClick","loading","props","handleClick","useCallback","args","StyledButton","span","Controls","operation","buttons","visible","copyString","visibilityStyle","opacity","style","Operation","src","image","width","alt","name","button","event","callback","stopPropagation","title","text","copy","MainControls","onAdd","onRemove","onEdit","onSources","add","trash","edit","code","ConfirmControls","onConfirm","onCancel","editMode","confirm","cancel","AddControls","onObject","onValue","section","ConfirmationModes","useEscapeKey","onEscape","useEffect","handleEsc","keyCode","window","addEventListener","removeEventListener","getUrlParams","url","URL","location","href","deepLKey","searchParams","get","sessionId","ControlsContainer","editing","onConfirmEdit","onCancelEdit","onBeginEdit","useState","mode","setMode","withResetMode","fn","remove","GoogleTranslateButton","fromLanguage","toLanguage","encodeURIComponent","target","rel","googleTranslate","DeepLTranslateButton","onResult","setLoading","deepLTranslate","source_lang","toUpperCase","target_lang","auth_key","free_api","endsWith","then","result","data","translations","catch","error","console","finally","deepl","SourceMatch","file","line","contextStartLine","context","idPosition","indexOf","Header","File","FileName","highlighted","content","LineContent","Line","LineNumber","vscode","pre","Value","language","onChange","issues","hintForTranslation","autoFocus","setAutoFocus","focused","setFocused","inputStyle","setInputStyle","cancelEdit","change","ValueContainer","LanguageTag","ValueEditor","onFocus","ref","elem","select","ValueButtons","ValueWrapper","hint","join","onDoubleClick","offsetWidth","height","offsetHeight","left","offsetLeft","maxWidth","document","body","ValueNode","showControls","setShowControls","showSources","setShowSources","setEditing","setValues","useContext","onChangeValue","problematicTranslations","disabled","problemHints","hasSourceMatches","onMouseEnter","onMouseLeave","Label","ValuesContainer","sameAsLanguage","keys","find","differentInLanguage","hintLanguage","newValue","s","Sources","expanded","textarea","ObjectNode","setExpanded","addingType","setAddingType","addingLabel","setAddingLabel","filteredIds","collapseAll","onCollapseChange","stopAdding","mainProblem","addingValid","test","onConfirmAdd","onToggleCollapse","c","NodeContainer","Caret","Collapsed","NewItemInput","placeholder","onKeyPress","e","key","SubTree","input","Tree","textFilter","problemsFilter","setProblematicTranslations","textFilteredIds","setTextFilteredIds","IDs","problemIdMap","reduce","aggr","Provider","label","parentId","cloneDeep","item","split","first","parts","child","changeValue","traversed","initializeParse","initialSessionId","useParse","supportedLanguages","useParseQuery","Parse","Query","enableLocalDatastore","enableLiveQuery","results","setSession","query","equalTo","save","set","history","pushState","setUrlParam","object","attributes","applyModification","newData","ALL_PROBLEMS","App","setCollapseAll","setCaseSensitive","setFilter","setLanguages","showLanguageSelection","setShowLanguageSelection","showProblemsSelection","setShowProblemsSelection","filteredProblems","setFilteredProblems","AppContainer","TopBar","SelectionWrapper","Selection","checked","prev","x","Collapse","Filter","FilterInput","Content","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.257e21d4.chunk.js","sourcesContent":["import React, { useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nexport default function Footer() {\n  const year = useMemo(() => new Date().getFullYear(), []);\n  return <Container>{`© Pavel Zarecky, ${year}`}</Container>;\n}\n\nconst Container = styled.div`\n  padding-right: 15px;\n  text-align: end;\n`;\n","export interface TNodeValues {\n  [language: string]: string;\n}\n\nexport enum ActionType {\n  ADD = \"ADD\",\n  CHANGE_VALUE = \"CHANGE_VALUE\",\n  REMOVE = \"REMOVE\",\n  OPEN = \"OPEN\",\n  DATA_UPDATE = \"DATA_UPDATE\",\n  SOURCE_MATCHES_UPDATE = \"SOURCE_MATCHES_UPDATE\",\n}\n\nexport enum MatchType {\n  EXACT = \"exact\",\n  PARTIAL = \"partial\",\n}\n\nexport interface TSourceMatch {\n  id: string;\n  file: string;\n  line: number;\n  contextStartLine: number;\n  context: string[];\n  type: MatchType;\n}\n\nexport enum NodeType {\n  OBJECT = \"OBJECT\",\n  VALUE = \"VALUE\",\n}\n\nexport type TObjectNode = {\n  id: string;\n  name: string;\n  type: NodeType.OBJECT;\n  children: TNode[];\n};\n\nexport type TValueNode = {\n  id: string;\n  name: string;\n  type: NodeType.VALUE;\n  exactSourceMatches?: TSourceMatch[];\n  partialSourceMatches?: TSourceMatch[];\n  values: TNodeValues;\n};\n\nexport type TNode = TObjectNode | TValueNode;\n","import { MatchType, NodeType, TNode, TSourceMatch } from \"../protocol\";\nimport { isEqual } from \"lodash\";\n\nexport const NO_PROBLEM = \"NO_PROBLEM\";\nexport enum Problem {\n  MISSING = \"MISSING\", // completely missing\n  EMPTY = \"EMPTY\", // only whitespaces, or empty section\n  DEFAULT = \"DEFAULT\", // default label used\n  SAME = \"SAME\", // same entry for multiple languages\n  PLACEHOLDER_MISMATCH = \"PLACEHOLDER_MISMATCH\", // placeholders don't match between languages\n  NO_MATCH_IN_SOURCES = \"NO_MATCH_IN_SOURCES\", // not found in any source file\n  PARTIAL_MATCH_IN_SOURCES = \"PARTIAL_MATCH_IN_SOURCES\", // only parent node found in source files\n}\n\nexport function extractPlaceholders(value?: string) {\n  const matches = value?.match(/{{\\w+}}/g);\n  if (!matches) return [];\n\n  return Array.from(\n    new Set(matches.map((p) => p.substring(2, p.length - 2)))\n  ).sort();\n}\n\nfunction findProblemsTraverse(\n  node: TNode,\n  languages: string[],\n  sourceMatches: TSourceMatch[] | undefined,\n  report: (id: string, problem: Problem) => void\n) {\n  switch (node.type) {\n    case NodeType.VALUE:\n      {\n        node.exactSourceMatches =\n          sourceMatches?.filter(\n            ({ id, type }) => id === node.id && type === MatchType.EXACT\n          ) || [];\n        node.partialSourceMatches =\n          sourceMatches?.filter(\n            ({ id }) =>\n              node.id.startsWith(`${id}.`) || node.id.startsWith(`${id}_plural`)\n          ) || [];\n\n        if (\n          languages.some(\n            (l) => node.values[l] === undefined || node.values[l] === null\n          )\n        ) {\n          report(node.id, Problem.MISSING);\n        } else if (languages.some((l) => !node.values[l].trim())) {\n          report(node.id, Problem.EMPTY);\n        }\n\n        const foundSourceMatch = node.exactSourceMatches.length;\n        const foundPartialSourceMatch = node.partialSourceMatches.length;\n        if (!foundSourceMatch) {\n          if (foundPartialSourceMatch) {\n            report(node.id, Problem.PARTIAL_MATCH_IN_SOURCES);\n          } else {\n            report(node.id, Problem.NO_MATCH_IN_SOURCES);\n          }\n        }\n\n        if (\n          Object.values(node.values)\n            .sort()\n            .some((v, index, sorted) => index && v === sorted[index - 1])\n        ) {\n          report(node.id, Problem.SAME);\n        }\n\n        if (languages.some((l) => node.values[l] === node.id)) {\n          report(node.id, Problem.DEFAULT);\n        }\n\n        if (\n          Object.values(node.values)\n            .map(extractPlaceholders)\n            .some(\n              (placeholders, index, all) =>\n                index && !isEqual(placeholders, all[index - 1])\n            )\n        ) {\n          report(node.id, Problem.PLACEHOLDER_MISMATCH);\n        }\n      }\n      break;\n    case NodeType.OBJECT:\n      if (!node.children.length) {\n        return report(node.id, Problem.EMPTY);\n      }\n      node.children.forEach((n) =>\n        findProblemsTraverse(n, languages, sourceMatches, report)\n      );\n      break;\n  }\n}\n\nexport type TFindProblemsResult = Array<{ id: string; problem: Problem }>;\nexport function findProblems(\n  node: TNode,\n  languages: string[],\n  sourceMatches?: TSourceMatch[]\n) {\n  const problems: TFindProblemsResult = [];\n  findProblemsTraverse(\n    node,\n    languages,\n    sourceMatches,\n    (id: string, problem: Problem) => {\n      if (!sourceMatches && problem === Problem.NO_MATCH_IN_SOURCES) return;\n      problems.push({ id, problem });\n    }\n  );\n  return problems;\n}\n","import { NodeType, TNode } from \"../protocol\";\n\nfunction findFilteredIDsTraverse(\n  node: TNode,\n  filter: string,\n  caseSensitive: boolean,\n  report: (id: string) => void\n) {\n  function isMatch(id?: string) {\n    return caseSensitive\n      ? id?.includes(filter)\n      : id?.toLowerCase().includes(filter.toLowerCase());\n  }\n\n  switch (node.type) {\n    case NodeType.VALUE:\n      if (isMatch(node.id) || Object.values(node.values).some(isMatch)) {\n        report(node.id);\n      }\n      break;\n    case NodeType.OBJECT:\n      if (!node.children.length && isMatch(node.id)) {\n        report(node.id);\n      }\n      node.children.forEach((n) =>\n        findFilteredIDsTraverse(n, filter, caseSensitive, report)\n      );\n      break;\n  }\n}\n\nexport function findFilteredIDs(\n  node: TNode,\n  filter: string,\n  caseSensitive: boolean\n) {\n  const ids: string[] = [];\n  findFilteredIDsTraverse(node, filter, caseSensitive, (id) => {\n    ids.push(id);\n  });\n  return ids;\n}\n\nfunction findIDsTraverse(node: TNode, report: (id: string) => void) {\n  switch (node.type) {\n    case NodeType.VALUE:\n      report(node.id);\n      break;\n    case NodeType.OBJECT:\n      if (!node.children.length) {\n        report(node.id);\n      }\n      node.children.forEach((n) => findIDsTraverse(n, report));\n      break;\n  }\n}\n\nexport function findIDs(node: TNode) {\n  const ids: string[] = [];\n  findIDsTraverse(node, (id) => {\n    ids.push(id);\n  });\n  return ids;\n}\n","import React from \"react\";\nimport { NodeType } from \"../protocol\";\nimport { TFindProblemsResult } from \"./problem\";\n\ntype Props = {\n  collapseAll?: boolean;\n  onCollapseChange?: () => void;\n  disabled?: boolean;\n  filteredIds?: string[];\n  problematicTranslations?: TFindProblemsResult;\n  languages?: string[];\n  onAdd?: (id: string, type: NodeType, label: string) => void;\n  onChangeValue?: (id: string, language: string, value: string) => void;\n  onRemove?: (id: string) => void;\n};\n\nexport const TreeContext = React.createContext<Props>({});\n","export default __webpack_public_path__ + \"static/media/add.d8693632.svg\";","export default __webpack_public_path__ + \"static/media/edit.962e7af9.svg\";","export default __webpack_public_path__ + \"static/media/confirm.0addefb3.svg\";","export default __webpack_public_path__ + \"static/media/cancel.caea72e4.svg\";","export default __webpack_public_path__ + \"static/media/trash.85c719f0.svg\";","export default __webpack_public_path__ + \"static/media/copy.2327b577.svg\";","export default __webpack_public_path__ + \"static/media/code.33554129.svg\";","export default __webpack_public_path__ + \"static/media/section.774f12f9.svg\";","export default __webpack_public_path__ + \"static/media/value.cddb19bc.svg\";","export default __webpack_public_path__ + \"static/media/vscode.ea98ae01.svg\";","export default __webpack_public_path__ + \"static/media/google-translate.0346cfbe.svg\";","export default __webpack_public_path__ + \"static/media/deepl.36a3b23e.svg\";","import styled from \"styled-components\";\nimport React, { useCallback } from \"react\";\n\ntype TButtonProps = React.HTMLAttributes<HTMLSpanElement> & {\n  loading?: boolean;\n};\n\nexport function Button({ onClick, loading, ...props }: TButtonProps) {\n  const handleClick = useCallback(\n    (...args: Parameters<React.MouseEventHandler<HTMLSpanElement>>) => {\n      if (loading) return;\n      onClick?.(...args);\n    },\n    [loading, onClick]\n  );\n\n  return <StyledButton onClick={handleClick} loading={loading} {...props} />;\n}\n\nexport const StyledButton = styled.span`\n  cursor: pointer;\n  vertical-align: middle;\n  padding: 0;\n  border: none;\n  background: none;\n  opacity: 0.5;\n  min-width: 1em;\n  margin: 0 3px;\n\n  &:hover {\n    opacity: ${({ loading }: { loading?: boolean }) => (loading ? \"0.5\" : \"1\")};\n    font-weight: bold;\n  }\n\n  &:hover > * {\n    transform: scale(1.5, 1.5);\n  }\n`;\n","import {\n  add,\n  edit,\n  confirm,\n  cancel,\n  trash,\n  copy,\n  code,\n  section,\n  value,\n} from \"../images\";\nimport styled from \"styled-components\";\nimport { Button } from \"./Button\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\n\ntype TOperation = {\n  name: string;\n  image: string;\n};\n\ntype TButton = {\n  name: string;\n  image: string;\n  callback: () => void;\n};\n\ntype TControlsProps = {\n  operation?: TOperation;\n  visible?: boolean;\n  copyString?: string;\n  buttons: Array<TButton | null | undefined>;\n};\n\nfunction Controls({\n  operation,\n  buttons,\n  visible = true,\n  copyString,\n}: TControlsProps) {\n  const visibilityStyle = {\n    opacity: visible ? 1 : 0,\n  };\n  return (\n    <Container style={visibilityStyle}>\n      {operation ? (\n        <Operation>\n          <img src={operation.image} width=\"16\" alt={operation.name} />\n        </Operation>\n      ) : null}\n      {buttons.map((button) =>\n        button ? (\n          <Button\n            key={button.name}\n            onClick={(event) => {\n              button.callback();\n              event.stopPropagation();\n            }}\n            title={button.name}\n          >\n            <img src={button.image} width=\"12\" alt={button.name} />\n          </Button>\n        ) : null\n      )}\n      {copyString ? (\n        <CopyToClipboard text={copyString}>\n          <Button title={`copy \"${copyString}\"`}>\n            <img src={copy} width=\"12\" alt={`copy ${copyString}`} />\n          </Button>\n        </CopyToClipboard>\n      ) : null}\n    </Container>\n  );\n}\n\ntype TMainControlsProps = {\n  visible?: boolean;\n  onAdd?: () => void;\n  onRemove?: () => void;\n  onEdit?: () => void;\n  onSources?: () => void;\n  copyString?: string;\n};\n\nexport function MainControls({\n  visible,\n  onAdd,\n  onRemove,\n  onEdit,\n  onSources,\n  copyString,\n}: TMainControlsProps) {\n  return (\n    <Controls\n      visible={visible}\n      buttons={[\n        onAdd && { name: \"add\", image: add, callback: onAdd },\n        onRemove && { name: \"remove\", image: trash, callback: onRemove },\n        onEdit && { name: \"edit\", image: edit, callback: onEdit },\n        onSources && {\n          name: \"show in sources\",\n          image: code,\n          callback: onSources,\n        },\n      ]}\n      copyString={copyString}\n    />\n  );\n}\n\ntype TConfirmControlsProps = {\n  editMode?: boolean;\n  onConfirm: () => void;\n  onCancel: () => void;\n};\n\nexport function ConfirmControls({\n  onConfirm,\n  onCancel,\n  editMode,\n}: TConfirmControlsProps) {\n  const name = editMode ? \"edit\" : \"remove\";\n  return (\n    <Controls\n      operation={{\n        name,\n        image: editMode ? edit : trash,\n      }}\n      buttons={[\n        { name: `confirm ${name}`, image: confirm, callback: onConfirm },\n        { name: `cancel ${name}`, image: cancel, callback: onCancel },\n      ]}\n    />\n  );\n}\n\ntype TAddControlsProps = {\n  onObject: () => void;\n  onValue: () => void;\n  onCancel: () => void;\n};\n\nexport function AddControls({\n  onObject,\n  onValue,\n  onCancel,\n}: TAddControlsProps) {\n  return (\n    <Controls\n      operation={{\n        name: \"add\",\n        image: add,\n      }}\n      buttons={[\n        { name: \"section\", image: section, callback: onObject },\n        { name: \"value\", image: value, callback: onValue },\n        { name: \"cancel\", image: cancel, callback: onCancel },\n      ]}\n    />\n  );\n}\n\nconst Container = styled.div`\n  cursor: default;\n`;\n\nconst Operation = styled.span`\n  font-size: 10px;\n  opacity: 0.8;\n`;\n","import { useEffect, useState } from \"react\";\nimport { MainControls, ConfirmControls, AddControls } from \"./Controls\";\nimport { NodeType } from \"../../protocol\";\nimport { useEscapeKey } from \"../util\";\n\nexport enum ConfirmationModes {\n  remove = \"REMOVE_MODE\",\n  edit = \"EDIT_MODE\",\n  add = \"ADD_MODE\",\n}\n\ntype TControlsContainerProps = {\n  editing?: boolean;\n  visible?: boolean;\n  onAdd?: (type: NodeType) => void;\n  onRemove?: () => void;\n  onConfirmEdit?: () => void;\n  onCancelEdit?: () => void;\n  onBeginEdit?: () => void;\n  onSources?: () => void;\n  copyString?: string;\n};\n\nexport const ControlsContainer = ({\n  editing,\n  visible,\n  onAdd,\n  onRemove,\n  onConfirmEdit,\n  onCancelEdit,\n  onBeginEdit = () => {},\n  onSources,\n  copyString,\n}: TControlsContainerProps) => {\n  const [mode, setMode] = useState(\n    editing ? ConfirmationModes.edit : undefined\n  );\n  useEffect(() => {\n    setMode(editing ? ConfirmationModes.edit : undefined);\n  }, [editing]);\n\n  function withResetMode(fn?: () => void) {\n    return () => {\n      setMode(undefined);\n      fn?.();\n    };\n  }\n\n  useEscapeKey(\n    mode &&\n      withResetMode(mode === ConfirmationModes.edit ? onCancelEdit : undefined)\n  );\n\n  switch (mode) {\n    case ConfirmationModes.add:\n      return (\n        <AddControls\n          // @ts-ignore\n          onObject={withResetMode(() => onAdd?.(NodeType.OBJECT))}\n          // @ts-ignore\n          onValue={withResetMode(() => onAdd?.(NodeType.VALUE))}\n          onCancel={withResetMode()}\n        />\n      );\n    case ConfirmationModes.remove:\n    case ConfirmationModes.edit:\n      return (\n        <ConfirmControls\n          editMode={mode === ConfirmationModes.edit}\n          onConfirm={withResetMode(\n            mode === ConfirmationModes.edit ? onConfirmEdit : onRemove\n          )}\n          onCancel={withResetMode(\n            mode === ConfirmationModes.edit ? onCancelEdit : undefined\n          )}\n        />\n      );\n    default:\n      return (\n        <MainControls\n          visible={visible}\n          copyString={copyString}\n          onAdd={onAdd && (() => setMode(ConfirmationModes.add))}\n          onRemove={onRemove && (() => setMode(ConfirmationModes.remove))}\n          onEdit={\n            onConfirmEdit &&\n            (() => {\n              setMode(ConfirmationModes.edit);\n              onBeginEdit?.();\n            })\n          }\n          onSources={onSources}\n        />\n      );\n  }\n};\n\nexport default ControlsContainer;\n","import { useEffect } from \"react\";\n\nexport const useEscapeKey = (onEscape?: () => void) => {\n  useEffect(() => {\n    if (!onEscape) return;\n    const handleEsc = (event: KeyboardEvent) => {\n      if (event.keyCode === 27) onEscape();\n    };\n    window.addEventListener(\"keydown\", handleEsc);\n\n    return () => {\n      window.removeEventListener(\"keydown\", handleEsc);\n    };\n  }, [onEscape]);\n};\n\nexport const getUrlParams = () => {\n  const url = new URL(window.location.href);\n  const deepLKey = url.searchParams.get(\"deepLKey\") || undefined;\n  const sessionId = url.searchParams.get(\"sessionId\") || undefined;\n  return { deepLKey, sessionId };\n};\n\nexport const setUrlParam = (name: string, value: string) => {\n  const url = new URL(window.location.href);\n  url.searchParams.set(name, value);\n  window.history.pushState({}, \"\", url.href);\n};\n","import React, { useCallback, useState } from \"react\";\nimport { googleTranslate, deepl } from \"../images\";\nimport { Button } from \"./Button\";\nimport deepLTranslate from \"deepl\";\nimport { getUrlParams } from \"../util\";\n\ntype TGoogleTranslateButtonProps = {\n  text: string;\n  fromLanguage: string;\n  toLanguage: string;\n};\n\nexport function GoogleTranslateButton({\n  text,\n  fromLanguage,\n  toLanguage,\n}: TGoogleTranslateButtonProps) {\n  const title = \"Open on GoogleTranslate\";\n  return (\n    <a\n      href={`https://translate.google.com/?sl=${encodeURIComponent(\n        fromLanguage\n      )}&tl=${encodeURIComponent(toLanguage)}&text=${encodeURIComponent(text)}`}\n      target=\"_blank\"\n      rel=\"noreferrer\"\n    >\n      <Button title={title}>\n        <img src={googleTranslate} width=\"12\" alt={title} />\n      </Button>\n    </a>\n  );\n}\n\nconst { deepLKey } = getUrlParams();\n\ntype TDeepLTranslateButtonProps = {\n  text: string;\n  fromLanguage: string;\n  toLanguage: string;\n  onResult: (text: string) => void;\n};\n\nexport function DeepLTranslateButton({\n  text,\n  fromLanguage,\n  toLanguage,\n  onResult,\n}: TDeepLTranslateButtonProps) {\n  const title = \"Translate with DeepL\";\n  const [loading, setLoading] = useState(false);\n  const onClick = useCallback(() => {\n    if (!deepLKey) return;\n    setLoading(true);\n    deepLTranslate({\n      text,\n      // @ts-ignore\n      source_lang: fromLanguage.toUpperCase(),\n      // @ts-ignore\n      target_lang: toLanguage.toUpperCase(),\n      auth_key: deepLKey,\n      free_api: deepLKey.endsWith(\":fx\"),\n    })\n      .then((result) => onResult(result.data.translations[0].text))\n      .catch((error) => console.error(error))\n      .finally(() => setLoading(false));\n  }, [text, fromLanguage, toLanguage, onResult]);\n\n  return !deepLKey ? null : (\n    <Button title={title} onClick={onClick} loading={loading}>\n      <img src={deepl} width=\"12\" alt={title} />\n    </Button>\n  );\n}\n","import React from \"react\";\nimport styled from \"styled-components\";\nimport { MatchType, TSourceMatch } from \"../../protocol\";\nimport { vscode } from \"../images\";\n\nexport function SourceMatch({\n  id,\n  file,\n  line,\n  contextStartLine,\n  context,\n  type,\n}: TSourceMatch) {\n  let idPosition: number | undefined =\n    context[line - contextStartLine]?.indexOf(id);\n  idPosition = idPosition === -1 ? undefined : idPosition;\n\n  return (\n    <Container type={type}>\n      <Header>\n        <File title=\"Open in VSCode\">\n          <FileName>{file}</FileName>:{line}\n        </File>\n      </Header>\n      {context.map((l, index) => {\n        const highlighted = line === index + contextStartLine;\n        let content = <LineContent>{l}</LineContent>;\n        if (highlighted && idPosition !== undefined) {\n          content = (\n            <>\n              <LineContent>{l.substring(0, idPosition)}</LineContent>\n              <LineContent highlighted>{id}</LineContent>\n              <LineContent>{l.substring(idPosition + id.length)}</LineContent>\n            </>\n          );\n        }\n        return (\n          <Line key={index} highlighted={highlighted} type={type}>\n            <LineNumber highlighted={highlighted}>\n              {index + contextStartLine}\n            </LineNumber>\n            {content}\n          </Line>\n        );\n      })}\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  border: 0.5px solid black;\n  border-color: ${({ type }: { type: MatchType }) =>\n    type === MatchType.EXACT ? \"black\" : \"darkseagreen\"};\n  font-family: monospace, monospace;\n`;\nconst Header = styled.div`\n  background-color: lightgrey;\n  padding: 0 8px;\n`;\nconst File = styled.span`\n  &:hover {\n    text-decoration: underline;\n    cursor: pointer;\n    :after {\n      padding-left: 4px;\n      content: url(${vscode});\n    }\n  }\n`;\nconst FileName = styled.span`\n  font-weight: bold;\n`;\nconst Line = styled.div`\n  background-color: ${({\n    highlighted,\n    type,\n  }: {\n    highlighted?: boolean;\n    type: MatchType;\n  }) =>\n    highlighted\n      ? type === MatchType.EXACT\n        ? \"lightgreen\"\n        : \"darkseagreen\"\n      : \"transparent\"};\n  margin: 0 8px;\n`;\nconst LineNumber = styled.span`\n  color: ${({ highlighted }: { highlighted?: boolean }) =>\n    highlighted ? \"black\" : \"lightgrey\"};\n  margin: 0 8px;\n  user-select: none;\n`;\nconst LineContent = styled.pre`\n  display: inline;\n  margin: 0;\n  font-weight: ${({ highlighted }: { highlighted?: boolean }) =>\n    highlighted ? \"bold\" : \"normal\"};\n`;\n","import { useState, useContext, useEffect, useCallback } from \"react\";\nimport SmoothCollapse from \"react-smooth-collapse\";\nimport ControlsContainer from \"./components/ControlsContainer\";\nimport styled from \"styled-components\";\nimport { TreeContext } from \"./Context\";\nimport { useEscapeKey } from \"./util\";\nimport {\n  GoogleTranslateButton,\n  DeepLTranslateButton,\n} from \"./components/TranslateButton\";\nimport { Problem, extractPlaceholders } from \"./problem\";\nimport { isEqual } from \"lodash\";\nimport { SourceMatch } from \"./components/SourceMatch\";\nimport { TValueNode } from \"../protocol\";\n\ntype TValueProps = {\n  language: string;\n  editing: boolean;\n  value: string;\n  onChange: (v: string) => void;\n  onEdit: (v: boolean) => void;\n  issues: Array<{\n    problem: Problem;\n    hint: string;\n  }>;\n  hintForTranslation?: {\n    language: string;\n    value: string;\n  };\n};\nfunction Value({\n  language,\n  editing,\n  value,\n  onChange,\n  onEdit,\n  issues,\n  hintForTranslation,\n}: TValueProps) {\n  const [autoFocus, setAutoFocus] = useState(false);\n  const [focused, setFocused] = useState(false);\n  const [inputStyle, setInputStyle] =\n    useState<{\n      width: number;\n      height: number;\n      maxWidth: number;\n    }>();\n  useEffect(() => {\n    if (!editing) {\n      setAutoFocus(false);\n      setFocused(false);\n    }\n  }, [editing]);\n\n  const cancelEdit = useCallback(() => onEdit(false), [onEdit]);\n  const change = useCallback(\n    (event) => {\n      onChange(event.target.value);\n      setAutoFocus(false);\n    },\n    [onChange]\n  );\n  useEscapeKey(editing ? cancelEdit : undefined);\n\n  return (\n    <ValueContainer>\n      <LanguageTag>{language}</LanguageTag>\n      {editing ? (\n        <>\n          <ValueEditor\n            style={inputStyle}\n            onFocus={() => setFocused(true)}\n            autoFocus={autoFocus}\n            value={value || \"\"}\n            onChange={change}\n            ref={(elem) => {\n              if (elem && autoFocus) elem.select();\n            }}\n          />\n          {focused && hintForTranslation ? (\n            <ValueButtons>\n              <DeepLTranslateButton\n                text={hintForTranslation.value}\n                fromLanguage={hintForTranslation.language}\n                toLanguage={language}\n                onResult={onChange}\n              />\n              <GoogleTranslateButton\n                text={hintForTranslation.value}\n                fromLanguage={hintForTranslation.language}\n                toLanguage={language}\n              />\n            </ValueButtons>\n          ) : null}\n        </>\n      ) : (\n        <ValueWrapper\n          problems={issues.map(({ problem }) => problem)}\n          title={\n            issues.length\n              ? issues.map(({ hint }) => hint).join(\"\\n\")\n              : undefined\n          }\n          onDoubleClick={() => {\n            setAutoFocus(true);\n            onEdit(true);\n          }}\n          ref={(elem) => {\n            if (elem) {\n              const width = elem.offsetWidth;\n              const height = elem.offsetHeight;\n              const left = elem.offsetLeft || 0;\n              if (\n                inputStyle?.width !== width ||\n                inputStyle?.height !== height\n              ) {\n                setInputStyle({\n                  width,\n                  height,\n                  maxWidth: document.body.offsetWidth - left - 100,\n                });\n              }\n            }\n          }}\n        >\n          {value?.trim()\n            ? value\n            : value === null || value === undefined\n            ? \"<missing>\"\n            : `\"${value}\"`}\n        </ValueWrapper>\n      )}\n    </ValueContainer>\n  );\n}\n\ntype TValueNodeProps = {\n  node: TValueNode;\n};\nexport function ValueNode({ node }: TValueNodeProps) {\n  const [showControls, setShowControls] = useState(false);\n  const [showSources, setShowSources] = useState(false);\n  const [editing, setEditing] = useState(false);\n  const [values, setValues] = useState(node.values);\n  const {\n    languages,\n    onChangeValue,\n    onRemove,\n    problematicTranslations,\n    disabled,\n  } = useContext(TreeContext);\n\n  useEscapeKey(showSources ? () => setShowSources(false) : undefined);\n\n  const onCancelEdit = useCallback(() => {\n    setValues(node.values);\n    setEditing(false);\n  }, [node]);\n\n  useEffect(() => {\n    if (disabled) {\n      onCancelEdit();\n    }\n  }, [disabled, onCancelEdit]);\n\n  const problems =\n    problematicTranslations\n      ?.filter(({ id }) => id === node.id)\n      .map(({ problem }) => problem) || [];\n\n  const problemHints = [];\n  if (problems.includes(Problem.NO_MATCH_IN_SOURCES))\n    problemHints.push(\"\\u26A0 No match found in the sources\");\n  if (problems.includes(Problem.PARTIAL_MATCH_IN_SOURCES))\n    problemHints.push(\"\\u26A0 Partial match in sourcefiles\");\n\n  const hasSourceMatches =\n    node.exactSourceMatches?.length || node.partialSourceMatches?.length;\n  return (\n    <>\n      <Container\n        onMouseEnter={() => setShowControls(true)}\n        onMouseLeave={() => setShowControls(false)}\n      >\n        <Label\n          title={\n            problemHints.length\n              ? `${node.id}\\n${problemHints.join(\"\\n\")}`\n              : node.id\n          }\n          problems={problems}\n        >\n          {node.name}\n        </Label>\n        <ValuesContainer>\n          {languages?.map((language) => {\n            const value = values[language];\n            const issues = [];\n\n            if (\n              problems.includes(Problem.MISSING) &&\n              (value === undefined || value === null)\n            ) {\n              issues.push({\n                problem: Problem.MISSING,\n                hint: \"\\u26A0 issue: Missing value\",\n              });\n            } else if (problems.includes(Problem.EMPTY) && !value?.trim()) {\n              issues.push({\n                problem: Problem.EMPTY,\n                hint: \"\\u26A0 Potential issue: Empty value\",\n              });\n            }\n\n            if (problems.includes(Problem.DEFAULT) && value === node.id) {\n              issues.push({\n                problem: Problem.DEFAULT,\n                hint: `\\u26A0 Potential issue: Default value used \"${value}\"`,\n              });\n            }\n\n            if (problems.includes(Problem.SAME)) {\n              const sameAsLanguage = Object.keys(values).find(\n                (l) => l !== language && values[l] === value\n              );\n              if (sameAsLanguage)\n                issues.push({\n                  problem: Problem.SAME,\n                  hint: `\\u26A0 Potential issue: The same as the \"${sameAsLanguage}\" version`,\n                });\n            }\n\n            if (problems.includes(Problem.PLACEHOLDER_MISMATCH)) {\n              const differentInLanguage = Object.keys(values).find(\n                (l) =>\n                  l !== language &&\n                  !isEqual(\n                    extractPlaceholders(values[l]),\n                    extractPlaceholders(value)\n                  )\n              );\n              if (differentInLanguage)\n                issues.push({\n                  problem: Problem.PLACEHOLDER_MISMATCH,\n                  hint: `\\u26A0 Potential issue: Different placeholders from the \"${differentInLanguage}\" version`,\n                });\n            }\n\n            const hintLanguage = Object.keys(values).find(\n              (l) => l !== language && values[l] && values[l] !== node.id\n            );\n\n            return (\n              <Value\n                key={language}\n                language={language}\n                editing={editing}\n                issues={issues}\n                value={value}\n                hintForTranslation={\n                  hintLanguage\n                    ? {\n                        language: hintLanguage,\n                        value: values[hintLanguage],\n                      }\n                    : undefined\n                }\n                onChange={(v) => setValues({ ...values, [language]: v })}\n                onEdit={(v) => {\n                  setEditing(!disabled && v);\n                  if (!v) {\n                    setValues(node.values);\n                  }\n                }}\n              />\n            );\n          })}\n        </ValuesContainer>\n        <ControlsContainer\n          visible={showControls || showSources}\n          editing={editing}\n          onBeginEdit={disabled ? undefined : () => setEditing(true)}\n          onConfirmEdit={\n            disabled\n              ? undefined\n              : () => {\n                  languages?.forEach((language) => {\n                    const newValue = values[language];\n                    const oldValue = node.values[language];\n                    if (newValue !== oldValue) {\n                      onChangeValue?.(node.id, language, newValue);\n                    }\n                  });\n                  setEditing(false);\n                }\n          }\n          onCancelEdit={disabled ? undefined : onCancelEdit}\n          onRemove={\n            disabled\n              ? undefined\n              : () => {\n                  onRemove?.(node.id);\n                }\n          }\n          onSources={\n            hasSourceMatches ? () => setShowSources((s) => !s) : undefined\n          }\n          copyString={node.id}\n        />\n      </Container>\n      <Sources>\n        <SmoothCollapse expanded={showSources}>\n          {node.exactSourceMatches?.map((match, index) => (\n            <SourceMatch key={`exact-${index}`} {...match} />\n          ))}\n          {node.partialSourceMatches?.map((match, index) => (\n            <SourceMatch key={`partial-${index}`} {...match} />\n          ))}\n        </SmoothCollapse>\n      </Sources>\n    </>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 2px;\n`;\n\nconst Label = styled.div`\n  cursor: default;\n  background-color: ${({ problems }: { problems: Problem[] }) =>\n    problems.includes(Problem.MISSING)\n      ? \"salmon\"\n      : problems.includes(Problem.EMPTY) || problems.includes(Problem.DEFAULT)\n      ? \"moccasin\"\n      : problems.includes(Problem.NO_MATCH_IN_SOURCES)\n      ? \"lightgray\"\n      : problems.includes(Problem.PARTIAL_MATCH_IN_SOURCES)\n      ? \"darkseagreen\"\n      : problems.length\n      ? \"lightcyan\"\n      : \"lightgreen\"};\n  font-family: monospace, monospace;\n  padding: 0 8px;\n  border: 0.5px solid black;\n  border-radius: 4px 0 0 4px;\n  display: flex;\n  align-items: center;\n  align-self: stretch;\n`;\n\nconst ValuesContainer = styled.div``;\n\nconst LanguageTag = styled.span`\n  cursor: default;\n  padding: 0 8px;\n  color: white;\n  background-color: black;\n`;\n\nconst Sources = styled.div`\n  padding-left: 20px;\n  margin-bottom: 4px;\n`;\n\nconst ValueContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  font-family: monospace, monospace;\n`;\n\nconst ValueWrapper = styled.div`\n  padding: 0 8px;\n  border: 0.5px solid black;\n  ${({ problems }: { problems: Problem[] }) =>\n    problems.includes(Problem.MISSING)\n      ? \"background-color: red; color: white; font-style: italic; font-family: sans-serif, monospace;\"\n      : problems.includes(Problem.EMPTY)\n      ? \"background-color: orange;\"\n      : problems.length\n      ? \"background-color: lightcyan;\"\n      : \"\"}\n`;\n\nconst ValueEditor = styled.textarea`\n  font-size: 16px;\n  min-height: 1em;\n`;\n\nconst ValueButtons = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n","import { useState, useContext, useCallback, useEffect } from \"react\";\nimport SmoothCollapse from \"react-smooth-collapse\";\nimport ControlsContainer from \"./components/ControlsContainer\";\nimport styled from \"styled-components\";\nimport { TreeContext } from \"./Context\";\nimport { NodeType, TObjectNode } from \"../protocol\";\nimport { ValueNode } from \"./ValueNode\";\nimport { confirm, cancel } from \"./images\";\nimport { Button } from \"./components/Button\";\nimport { useEscapeKey } from \"./util\";\nimport { Problem } from \"./problem\";\n\ntype TObjectNodeProps = {\n  node: TObjectNode;\n};\nexport function ObjectNode({ node }: TObjectNodeProps) {\n  const [expanded, setExpanded] = useState(!node.id);\n  const [showControls, setShowControls] = useState(false);\n  const [addingType, setAddingType] = useState<NodeType>();\n  const [addingLabel, setAddingLabel] = useState(\"\");\n\n  const {\n    onAdd,\n    onRemove,\n    problematicTranslations,\n    filteredIds,\n    disabled,\n    collapseAll,\n    onCollapseChange,\n  } = useContext(TreeContext);\n\n  const stopAdding = useCallback(() => {\n    setAddingType(undefined);\n    setAddingLabel(\"\");\n  }, []);\n\n  useEffect(() => {\n    if (!expanded || disabled) {\n      stopAdding();\n    }\n  }, [disabled, expanded, stopAdding]);\n\n  useEffect(() => {\n    if (collapseAll !== undefined) {\n      setExpanded(!collapseAll);\n    }\n  }, [collapseAll]);\n\n  useEscapeKey(addingType && stopAdding);\n\n  const problems = problematicTranslations\n    ?.filter(({ id }) => id === node.id || id.startsWith(`${node.id}.`))\n    .map(({ problem }) => problem);\n  const mainProblem = problems?.includes(Problem.MISSING)\n    ? Problem.MISSING\n    : problems?.includes(Problem.EMPTY)\n    ? Problem.EMPTY\n    : problems?.includes(Problem.NO_MATCH_IN_SOURCES)\n    ? Problem.NO_MATCH_IN_SOURCES\n    : problems?.includes(Problem.DEFAULT)\n    ? Problem.DEFAULT\n    : problems?.includes(Problem.SAME)\n    ? Problem.SAME\n    : undefined;\n\n  const addingValid =\n    addingLabel &&\n    /^\\w+$/.test(addingLabel) &&\n    !node.children.some(({ name }) => name === addingLabel);\n\n  const onConfirmAdd =\n    addingValid && addingType\n      ? () => {\n          onAdd?.(node.id, addingType, addingLabel);\n          stopAdding();\n        }\n      : undefined;\n\n  const onToggleCollapse = useCallback(() => {\n    onCollapseChange?.();\n    setExpanded((c) => !c);\n  }, [onCollapseChange]);\n  const onMouseEnter = useCallback(() => setShowControls(true), []);\n  const onMouseLeave = useCallback(() => setShowControls(false), []);\n\n  return (\n    <>\n      <NodeContainer\n        onClick={onToggleCollapse}\n        onMouseEnter={onMouseEnter}\n        onMouseLeave={onMouseLeave}\n      >\n        <Label\n          id={node.id}\n          problem={mainProblem}\n          expanded={expanded}\n          title={node.id}\n        >\n          <Caret>{expanded ? \"-\" : \"+\"}</Caret>\n          {node.name}\n        </Label>\n        {expanded ? (\n          !addingType &&\n          !disabled && (\n            <ControlsContainer\n              visible={showControls}\n              onAdd={(type) => setAddingType(type)}\n              onRemove={node.id ? () => onRemove?.(node.id) : undefined}\n            />\n          )\n        ) : (\n          <Collapsed>{`{} ${node.children.length} item${\n            node.children.length === 1 ? \"\" : \"s\"\n          }`}</Collapsed>\n        )}\n      </NodeContainer>\n      {addingType ? (\n        <>\n          <NewItemInput\n            type=\"text\"\n            autoFocus\n            placeholder={\n              addingType === NodeType.OBJECT ? \"new section\" : \"new value\"\n            }\n            onChange={(event) => setAddingLabel(event.target.value.trim())}\n            onKeyPress={(e) => e.key === \"Enter\" && onConfirmAdd?.()}\n          />\n          {addingValid ? (\n            <Button onClick={onConfirmAdd}>\n              <img src={confirm} width=\"16\" alt=\"confirm\" />\n            </Button>\n          ) : null}\n          <Button onClick={stopAdding}>\n            <img src={cancel} width=\"16\" alt=\"cancel\" />\n          </Button>\n        </>\n      ) : null}\n      <SubTree>\n        <SmoothCollapse expanded={expanded}>\n          {node.children.map((n) => {\n            if (\n              filteredIds &&\n              !filteredIds.some(\n                (id) => id === n.id || id.startsWith(`${n.id}.`)\n              )\n            ) {\n              return null;\n            }\n            return n.type === NodeType.OBJECT ? (\n              <ObjectNode key={n.id} node={n} />\n            ) : (\n              <ValueNode key={n.id} node={n} />\n            );\n          })}\n        </SmoothCollapse>\n      </SubTree>\n    </>\n  );\n}\n\nconst getLabelBackground = ({\n  id,\n  problem,\n  expanded,\n}: {\n  id: string;\n  problem?: Problem;\n  expanded: boolean;\n}) => {\n  if (!id) return \"white\";\n  switch (problem) {\n    case Problem.MISSING:\n      return expanded ? \"pink\" : \"salmon\";\n    case Problem.EMPTY:\n    case Problem.DEFAULT:\n      return expanded ? \"white\" : \"moccasin\";\n    case Problem.SAME:\n      return expanded ? \"white\" : \"lightcyan\";\n    case Problem.NO_MATCH_IN_SOURCES:\n      return expanded ? \"white\" : \"lightgrey\";\n    default:\n      return expanded ? \"mintcream\" : \"lightgreen\";\n  }\n};\n\nconst NodeContainer = styled.div`\n  cursor: default;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n`;\n\nconst Caret = styled.span`\n  min-width: 10px;\n  margin-right: 2px;\n`;\n\nconst Label = styled.span`\n  background-color: ${getLabelBackground};\n  font-family: monospace, monospace;\n  padding: 0 8px;\n  border: 0.5px solid black;\n  border-radius: 4px;\n\n  &:hover {\n    font-weight: bold;\n  }\n`;\n\nconst Collapsed = styled.span`\n  color: grey;\n  margin: 0 8px;\n`;\n\nconst SubTree = styled.div`\n  padding-left: 20px;\n  margin-bottom: 4px;\n`;\n\nconst NewItemInput = styled.input`\n  font-family: monospace, monospace;\n  font-size: 16px;\n  padding: 0 8px;\n  margin-left: 20px;\n  margin-bottom: 4px;\n`;\n","import { useEffect, useState } from \"react\";\nimport { NodeType, TObjectNode, TSourceMatch } from \"../protocol\";\nimport {\n  findProblems,\n  NO_PROBLEM,\n  Problem,\n  TFindProblemsResult,\n} from \"./problem\";\nimport { findIDs, findFilteredIDs } from \"./filter\";\nimport { TreeContext } from \"./Context\";\nimport { ObjectNode } from \"./ObjectNode\";\n\ntype TProblemsFilter = Array<Problem | typeof NO_PROBLEM>;\ntype TFilter = {\n  text: string;\n  caseSensitive: boolean;\n  problems: TProblemsFilter;\n};\n\ntype TreeProps = {\n  data: TObjectNode;\n  languages?: string[];\n  sourceMatches?: TSourceMatch[];\n  filter: TFilter;\n  onAdd?: (id: string, type: NodeType, label: string) => void;\n  onChangeValue?: (id: string, language: string, value: string) => void;\n  onRemove?: (id: string) => void;\n  disabled?: boolean;\n  collapseAll?: boolean;\n  onCollapseChange: () => void;\n};\n\nexport default function Tree({\n  data,\n  languages,\n  sourceMatches,\n  filter: { text: textFilter, caseSensitive, problems: problemsFilter },\n  onAdd,\n  onChangeValue,\n  onRemove,\n  disabled,\n  collapseAll,\n  onCollapseChange,\n}: TreeProps) {\n  const [problematicTranslations, setProblematicTranslations] =\n    useState<TFindProblemsResult>([]);\n  useEffect(() => {\n    if (languages?.length) {\n      setProblematicTranslations(findProblems(data, languages, sourceMatches));\n    }\n  }, [sourceMatches, data, languages]);\n\n  const [textFilteredIds, setTextFilteredIds] = useState<string[]>();\n  useEffect(() => {\n    if (data && textFilter) {\n      setTextFilteredIds(findFilteredIDs(data, textFilter, caseSensitive));\n    } else {\n      setTextFilteredIds(undefined);\n    }\n  }, [caseSensitive, textFilter, data]);\n\n  let filteredIds = textFilteredIds;\n  if (data && problemsFilter?.length) {\n    const IDs = textFilteredIds || findIDs(data);\n\n    const problemIdMap = problematicTranslations.reduce<{\n      [id: string]: Problem[];\n    }>((aggr, { id, problem }) => {\n      if (aggr[id]) {\n        aggr[id].push(problem);\n      } else {\n        aggr[id] = [problem];\n      }\n      return aggr;\n    }, {});\n\n    filteredIds = IDs.filter(\n      (id) =>\n        (problemsFilter.includes(NO_PROBLEM) && !problemIdMap[id]) ||\n        problemIdMap[id]?.some((problem) => problemsFilter.includes(problem))\n    );\n  }\n\n  return (\n    <TreeContext.Provider\n      value={{\n        collapseAll,\n        onCollapseChange,\n        disabled,\n        filteredIds,\n        problematicTranslations,\n        languages: languages,\n        onAdd,\n        onChangeValue,\n        onRemove,\n      }}\n    >\n      {data ? <ObjectNode node={data} /> : null}\n    </TreeContext.Provider>\n  );\n}\n","import { cloneDeep } from \"lodash\";\nimport { NodeType, TObjectNode } from \"./protocol\";\n\nexport function add(\n  node: TObjectNode,\n  id: string,\n  type: NodeType,\n  label: string,\n  parentId?: string\n): TObjectNode {\n  const result = parentId ? node : cloneDeep(node);\n  if (!id) {\n    const item = {\n      id: parentId ? `${parentId}.${label}` : label,\n      name: label,\n    };\n    result.children.push(\n      type === NodeType.OBJECT\n        ? { ...item, type, children: [] }\n        : { ...item, type, values: {} }\n    );\n\n    return result;\n  }\n\n  const [first, ...parts] = id.split(\".\");\n  const child = result.children.find(({ name }) => name === first);\n  if (child?.type === NodeType.OBJECT) {\n    add(\n      child,\n      parts.join(\".\"),\n      type,\n      label,\n      parentId ? `${parentId}.${first}` : first\n    );\n    return result;\n  }\n\n  console.error(\"ADD: Invalid ID\", id, type, node);\n  return result;\n}\n\nexport function changeValue(\n  node: TObjectNode,\n  id: string,\n  language: string,\n  value: string,\n  traversed?: boolean\n): TObjectNode {\n  const result = traversed ? node : cloneDeep(node);\n\n  const [first, ...parts] = id.split(\".\");\n  const child = result.children.find(({ name }) => name === first);\n  if (!child) {\n    console.error(\"CHANGE-VALUE: Invalid ID\", id, node);\n    return result;\n  }\n\n  if (child.type === NodeType.OBJECT) {\n    changeValue(child, parts.join(\".\"), language, value, true);\n  } else {\n    child.values[language] = value;\n  }\n\n  return result;\n}\n\nexport function remove(\n  node: TObjectNode,\n  id: string,\n  traversed?: boolean\n): TObjectNode {\n  const result = traversed ? node : cloneDeep(node);\n\n  const [first, ...parts] = id.split(\".\");\n  const child = result.children.find(({ name }) => name === first);\n  if (!child) {\n    console.error(\"REMOVE: ID not found\", id, node);\n    return result;\n  }\n\n  if (parts.length) {\n    if (child.type !== NodeType.OBJECT) {\n      console.error(\"REMOVE: Invalid type\", id, node);\n      return result;\n    }\n\n    remove(child, parts.join(\".\"), true);\n  } else {\n    result.children = result.children.filter(({ name }) => name !== first);\n  }\n\n  return result;\n}\n","import { NodeType, TObjectNode } from \"./protocol\";\nimport { getUrlParams, setUrlParam } from \"./tree/util\";\nimport Parse from \"parse\";\nimport { initializeParse, useParseQuery } from \"@parse/react\";\nimport { useEffect, useMemo, useState } from \"react\";\nimport { add, changeValue, remove } from \"./action\";\n\ninitializeParse(\n  \"https://translation.b4a.io/\",\n  \"ZqSPDyNGkCzQYoQfxgGEUgpO4tp9Rc7z4DhJQNWI\",\n  \"6aZHlL6cm2kX99WmKTATP7rZUCGvPmNNpFF76EqM\"\n);\n\ninterface TLanguage {\n  code: string;\n}\n\ninterface TTranslation {\n  data: TObjectNode;\n}\n\nconst { sessionId: initialSessionId } = getUrlParams();\n\ntype UseParseResult = {\n  data?: TObjectNode;\n  supportedLanguages: string[];\n  onAdd?: (id: string, type: NodeType, label: string) => void;\n  onChangeValue?: (id: string, language: string, value: string) => void;\n  onRemove?: (id: string) => void;\n};\n\nexport function useParse(): UseParseResult {\n  const { results: supportedLanguages } = useParseQuery<\n    Parse.Object<TLanguage>\n  >(\n    useMemo(() => new Parse.Query(\"Language\"), []),\n    {\n      enableLocalDatastore: true,\n      enableLiveQuery: false,\n    }\n  );\n\n  const [sessionId, setSession] = useState(initialSessionId);\n  const { results: translations } = useParseQuery<Parse.Object<TTranslation>>(\n    useMemo(() => {\n      const query = new Parse.Query<Parse.Object<TTranslation>>(\"Translation\");\n      return sessionId ? query.equalTo(\"objectId\", sessionId) : query;\n    }, [sessionId]),\n    {\n      enableLocalDatastore: true,\n      enableLiveQuery: true,\n    }\n  );\n\n  useEffect(() => {\n    if (!sessionId) {\n      const newSession = new Parse.Object<TTranslation>(\"Translation\", {\n        data: {\n          id: \"\",\n          name: \"root\",\n          type: NodeType.OBJECT,\n          children: [],\n        },\n      });\n      newSession\n        .save()\n        .then((s) => {\n          setSession(s.id);\n          setUrlParam(\"sessionId\", s.id);\n        })\n        .catch((e) => console.error(e));\n    }\n  }, [sessionId]);\n\n  const object = translations?.[0];\n  const data = object?.attributes.data;\n  const applyModification = (newData: TObjectNode) => {\n    object?.set({ data: newData });\n    object?.save();\n  };\n  return {\n    data,\n    supportedLanguages:\n      supportedLanguages?.map(({ attributes: { code } }) => code) || [],\n    onAdd:\n      data &&\n      ((id: string, type: NodeType, label: string) =>\n        applyModification(add(data, id, type, label))),\n    onChangeValue:\n      data &&\n      ((id: string, language: string, value: string) =>\n        applyModification(changeValue(data, id, language, value))),\n    onRemove: data && ((id: string) => applyModification(remove(data, id))),\n  };\n}\n","import Footer from \"./Footer\";\nimport { useCallback, useState } from \"react\";\nimport Tree from \"./tree/Tree\";\nimport { Problem, NO_PROBLEM } from \"./tree/problem\";\nimport styled from \"styled-components\";\nimport { useParse } from \"./parse\";\n\nconst ALL_PROBLEMS = (\n  [NO_PROBLEM, ...Object.values(Problem)] as Array<Problem | typeof NO_PROBLEM>\n).filter(\n  (p) =>\n    p !== Problem.NO_MATCH_IN_SOURCES && p !== Problem.PARTIAL_MATCH_IN_SOURCES\n);\n\nexport default function App() {\n  const { data, supportedLanguages, onAdd, onChangeValue, onRemove } =\n    useParse();\n\n  const [collapseAll, setCollapseAll] = useState<boolean>();\n\n  const [caseSensitive, setCaseSensitive] = useState(false);\n  const [filter, setFilter] = useState(\"\");\n  const [languages, setLanguages] = useState<string[]>([]);\n  const [showLanguageSelection, setShowLanguageSelection] = useState(false);\n  const [showProblemsSelection, setShowProblemsSelection] = useState(false);\n  const [filteredProblems, setFilteredProblems] = useState<\n    Array<Problem | typeof NO_PROBLEM>\n  >([]);\n\n  const onCollapseChange = useCallback(() => setCollapseAll(undefined), []);\n\n  return (\n    <AppContainer>\n      <TopBar>\n        <SelectionWrapper>\n          <button onClick={() => setShowLanguageSelection((s) => !s)}>\n            Languages\n          </button>\n          {showLanguageSelection && (\n            <Selection>\n              {supportedLanguages.map((v) => (\n                <span key={v}>\n                  <input\n                    type=\"checkbox\"\n                    name={v}\n                    checked={languages.includes(v)}\n                    onChange={(event) =>\n                      setLanguages((prev) =>\n                        event.target.checked\n                          ? [...prev, v]\n                          : prev.filter((x) => x !== v)\n                      )\n                    }\n                  />\n                  {v}\n                </span>\n              ))}\n            </Selection>\n          )}\n        </SelectionWrapper>\n        <Collapse>\n          <span>\n            <button\n              disabled={collapseAll === false}\n              onClick={() => setCollapseAll(false)}\n              title=\"Expand All\"\n            >\n              +\n            </button>\n            <button\n              disabled={collapseAll}\n              onClick={() => setCollapseAll(true)}\n              title=\"Collapse All\"\n            >\n              -\n            </button>\n          </span>\n        </Collapse>\n        <Filter>\n          <span>\n            Filter:\n            <FilterInput\n              onChange={(event) => setFilter(event.target.value.trim())}\n            />\n            <input\n              type=\"checkbox\"\n              name=\"case sensitive\"\n              checked={caseSensitive}\n              onChange={(event) => setCaseSensitive(event.target.checked)}\n            />\n            case sensitive\n            <SelectionWrapper>\n              <button onClick={() => setShowProblemsSelection((s) => !s)}>\n                Problems\n              </button>\n              {showProblemsSelection && (\n                <Selection>\n                  {ALL_PROBLEMS.map((v) => (\n                    <span key={v}>\n                      <input\n                        type=\"checkbox\"\n                        name={v}\n                        checked={filteredProblems.includes(v)}\n                        onChange={(event) =>\n                          setFilteredProblems((prev) =>\n                            event.target.checked\n                              ? [...prev, v]\n                              : prev.filter((x) => x !== v)\n                          )\n                        }\n                      />\n                      {v}\n                    </span>\n                  ))}\n                </Selection>\n              )}\n            </SelectionWrapper>\n          </span>\n        </Filter>\n      </TopBar>\n      <Content>\n        {!data ? (\n          \"No data\"\n        ) : (\n          <Tree\n            data={data}\n            languages={languages}\n            collapseAll={collapseAll}\n            onCollapseChange={onCollapseChange}\n            filter={{ text: filter, caseSensitive, problems: filteredProblems }}\n            onAdd={onAdd}\n            onChangeValue={onChangeValue}\n            onRemove={onRemove}\n          />\n        )}\n      </Content>\n\n      <Footer />\n    </AppContainer>\n  );\n}\n\nconst AppContainer = styled.div`\n  background-color: #ffffff;\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Roboto\", \"Oxygen\",\n    \"Ubuntu\", \"Cantarell\", \"Fira Sans\", \"Droid Sans\", \"Helvetica Neue\",\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  font-weight: 400;\n`;\n\nconst TopBar = styled.div`\n  width: 100vw;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  padding-left: 1em;\n  padding-right: 1em;\n`;\n\nconst Collapse = styled.div`\n  flex: 1;\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst Filter = styled.div`\n  flex: 3;\n  display: flex;\n  justify-content: space-around;\n`;\n\nconst SelectionWrapper = styled.div`\n  position: relative;\n`;\n\nconst FilterInput = styled.input`\n  font-family: monospace, monospace;\n  font-size: 16px;\n  padding: 0 8px;\n  margin-left: 1em;\n  min-width: min(50vw, 400px);\n`;\n\nconst Selection = styled.div`\n  position: absolute;\n  background-color: #ffffff;\n  border: 0.5px solid black;\n  padding: 10px;\n  display: flex;\n  flex-direction: column;\n  z-index: 1;\n`;\n\nconst Content = styled.div`\n  flex: 1;\n  min-width: 800px;\n  max-width: 95vw;\n  margin: 0 40px;\n  padding-top: 15px;\n  flex-direction: column;\n  align-items: center;\n`;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}