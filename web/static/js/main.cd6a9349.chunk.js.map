{"version":3,"sources":["protocol.js","Footer.js","tree/problem.js","tree/Context.js","tree/images/add.svg","tree/images/edit.svg","tree/images/confirm.svg","tree/images/cancel.svg","tree/images/trash.svg","tree/images/copy.svg","tree/images/google-translate.svg","tree/components/Button.js","tree/components/Controls.js","tree/util.js","tree/components/ControlsContainer.js","tree/components/TranslateButton.js","tree/ValueNode.js","tree/ObjectNode.js","tree/Tree.js","App.js","index.js"],"names":["ActionType","ADD","CHANGE_VALUE","REMOVE","DATA_UPDATE","Action","add","parentId","type","label","action","changeValue","id","language","value","remove","dataUpdate","data","module","exports","NodeType","OBJECT","VALUE","Footer","year","useMemo","Date","getFullYear","Container","styled","div","Problem","extractPlaceholders","matches","match","Array","from","Set","map","p","substring","length","sort","findProblemsTraverse","node","languages","report","some","l","undefined","values","trim","Object","v","index","sorted","placeholders","all","isEqual","children","forEach","n","Error","findProblems","problems","problem","push","TreeContext","React","createContext","Button","span","Controls","operation","buttons","visible","copyString","visibilityStyle","opacity","style","Operation","src","image","width","alt","name","button","onClick","event","callback","stopPropagation","title","text","copy","MainControls","onAdd","onRemove","onEdit","trash","edit","ConfirmControls","onConfirm","onCancel","editMode","confirm","cancel","AddControls","onObject","onValue","useEscapeKey","onEscape","useEffect","handleEsc","keyCode","window","addEventListener","removeEventListener","ConfirmationModes","ControlsContainer","editing","onConfirmEdit","onCancelEdit","onBeginEdit","useState","mode","setMode","withResetMode","fn","args","defaultProps","TranslateButton","fromLanguage","toLanguage","onResult","href","encodeURIComponent","target","rel","googleTranslate","Value","onChange","hint","highlight","autoFocus","setAutoFocus","focused","setFocused","inputWidth","setInputWidth","cancelEdit","useCallback","ValueContainer","LanguageTag","ValueEditor","onFocus","ValueWrapper","onDoubleClick","ref","elem","offsetWidth","ValueNode","showControls","setShowControls","setEditing","setValues","useContext","onChangeValue","problematicTranslations","disabled","find","onMouseEnter","onMouseLeave","Label","ValuesContainer","hintLanguage","keys","highlightLanguage","newValue","textarea","ObjectNode","expanded","setExpanded","adding","setAdding","addingLabel","setAddingLabel","stopAdding","filter","startsWith","includes","addingValid","test","onConfirmAdd","NodeContainer","c","Caret","Collapsed","NewItemInput","placeholder","onKeyPress","e","key","SubTree","input","Tree","onSendMessage","root","setRoot","setProblematicTranslations","content","Provider","App","serverHost","url","URL","location","serverPort","searchParams","get","port","hostname","getServerHost","setData","handleIncomingMessage","console","error","useWebSocket","retryOnError","shouldReconnect","reconnectAttempts","onMessage","ev","JSON","parse","sendMessage","readyState","getStatusLabel","ReadyState","OPEN","CONNECTING","CLOSED","message","stringify","fetch","then","response","json","AppContainer","ConnectionStatus","status","Content","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.cd6a9349.chunk.js","sourcesContent":["const NodeType = {\n  OBJECT: \"OBJECT\",\n  VALUE: \"VALUE\",\n};\n\nconst ActionType = {\n  ADD: \"ADD\",\n  CHANGE_VALUE: \"CHANGE_VALUE\",\n  REMOVE: \"REMOVE\",\n  DATA_UPDATE: \"DATA_UPDATE\",\n};\n\nconst Action = {\n  add: (parentId, type, label) => ({\n    action: ActionType.ADD,\n    parentId,\n    type,\n    label,\n  }),\n  changeValue: (id, language, value) => ({\n    action: ActionType.CHANGE_VALUE,\n    id,\n    language,\n    value,\n  }),\n  remove: (id) => ({\n    action: ActionType.REMOVE,\n    id,\n  }),\n  dataUpdate: (data) => ({\n    action: ActionType.DATA_UPDATE,\n    data\n  }),\n};\n\nmodule.exports = { NodeType, ActionType, Action };\n","import React, { useMemo } from \"react\";\nimport styled from \"styled-components\";\n\nexport default function Footer() {\n  const year = useMemo(() => new Date().getFullYear(), []);\n  return <Container>{`Â© Pavel Zarecky, ${year}`}</Container>;\n}\n\nconst Container = styled.div`\n  padding-right: 15px;\n  text-align: end;\n`;\n","import { NodeType } from \"../protocol\";\nimport { isEqual } from \"lodash\";\n\nexport const Problem = {\n  MISSING: \"MISSING\", // completely missing\n  EMPTY: \"EMPTY\", // only whitespaces, or empty section\n  SAME: \"SAME\", // same entry for multiple languages\n  PLACEHOLDER_MISMATCH: \"PLACEHOLDER_MISMATCH\", // same entry for multiple languages\n};\n\nexport function extractPlaceholders(value) {\n  const matches = value.match(/{{\\w+}}/g);\n  if (!matches) return [];\n\n  return Array.from(\n    new Set(matches.map((p) => p.substring(2, p.length - 2)))\n  ).sort();\n}\n\nfunction findProblemsTraverse(node, languages, report) {\n  switch (node.type) {\n    case NodeType.VALUE:\n      if (\n        languages.some(\n          (l) => node.values[l] === undefined || node.values[l] === null\n        )\n      ) {\n        return report(node.id, Problem.MISSING);\n      }\n\n      if (languages.some((l) => !node.values[l].trim())) {\n        return report(node.id, Problem.EMPTY);\n      }\n\n      if (\n        Object.values(node.values)\n          .sort()\n          .some((v, index, sorted) => index && v === sorted[index - 1])\n      ) {\n        return report(node.id, Problem.SAME);\n      }\n\n      if (\n        Object.values(node.values)\n          .map(extractPlaceholders)\n          .some(\n            (placeholders, index, all) =>\n              index && !isEqual(placeholders, all[index - 1])\n          )\n      ) {\n        return report(node.id, Problem.PLACEHOLDER_MISMATCH);\n      }\n\n      break;\n    case NodeType.OBJECT:\n      if (!node.children.length) {\n        return report(node.id, Problem.EMPTY);\n      }\n      node.children.forEach((n) => findProblemsTraverse(n, languages, report));\n      break;\n    default:\n      throw new Error(`Invalid type: ${node.type}`);\n  }\n}\n\nexport function findProblems(node, languages) {\n  const problems = [];\n  findProblemsTraverse(node, languages, (id, problem) => {\n    problems.push({ id, problem });\n  });\n  return problems;\n}\n","import React from \"react\";\n\nexport const TreeContext = React.createContext({});\n","export default __webpack_public_path__ + \"static/media/add.d8693632.svg\";","export default __webpack_public_path__ + \"static/media/edit.962e7af9.svg\";","export default __webpack_public_path__ + \"static/media/confirm.0addefb3.svg\";","export default __webpack_public_path__ + \"static/media/cancel.caea72e4.svg\";","export default __webpack_public_path__ + \"static/media/trash.85c719f0.svg\";","export default __webpack_public_path__ + \"static/media/copy.2327b577.svg\";","export default __webpack_public_path__ + \"static/media/google-translate.0346cfbe.svg\";","import styled from \"styled-components\";\n\nexport const Button = styled.span`\n  cursor: pointer;\n  vertical-align: middle;\n  padding: 0;\n  border: none;\n  background: none;\n  opacity: 0.5;\n  min-width: 1em;\n  margin: 0 3px;\n\n  &:hover {\n    opacity: 1;\n    font-weight: bold;\n  }\n\n  &:hover > * {\n    transform: scale(1.5, 1.5);\n  }\n`;\n","import React from \"react\";\nimport { bool, func, string } from \"prop-types\";\nimport { add, edit, confirm, cancel, trash, copy } from \"../images\";\nimport styled from \"styled-components\";\nimport { Button } from \"./Button\";\nimport { CopyToClipboard } from \"react-copy-to-clipboard\";\n\nfunction Controls({ operation, buttons, visible = true, copyString }) {\n  const visibilityStyle = {\n    opacity: visible ? 1 : 0,\n  };\n  return (\n    <Container style={visibilityStyle}>\n      {operation ? (\n        <Operation>\n          <img src={operation.image} width=\"16\" alt={operation.name} />\n        </Operation>\n      ) : null}\n      {buttons.map((button) =>\n        button ? (\n          <Button\n            key={button.name}\n            onClick={(event) => {\n              button.callback();\n              event.stopPropagation();\n            }}\n            title={button.name}\n          >\n            {button.image ? (\n              <img src={button.image} width=\"12\" alt={button.name} />\n            ) : null}\n            {button.text ? button.text : null}\n          </Button>\n        ) : null\n      )}\n      {copyString ? (\n        <CopyToClipboard text={copyString} title={`copy \"${copyString}\"`}>\n          <Button>\n            <img src={copy} width=\"12\" alt={`copy ${copyString}`} />\n          </Button>\n        </CopyToClipboard>\n      ) : null}\n    </Container>\n  );\n}\n\nexport function MainControls({ visible, onAdd, onRemove, onEdit, copyString }) {\n  return (\n    <Controls\n      visible={visible}\n      buttons={[\n        onAdd && { name: \"add\", image: add, callback: onAdd },\n        onRemove && { name: \"remove\", image: trash, callback: onRemove },\n        onEdit && { name: \"edit\", image: edit, callback: onEdit },\n      ]}\n      copyString={copyString}\n    />\n  );\n}\n\nMainControls.propTypes = {\n  visible: bool.isRequired,\n  onAdd: func,\n  onRemove: func,\n  onEdit: func,\n  copyString: string,\n};\n\nexport function ConfirmControls({ onConfirm, onCancel, editMode }) {\n  const name = editMode ? \"edit\" : \"remove\";\n  return (\n    <Controls\n      operation={{\n        name,\n        image: editMode ? edit : trash,\n      }}\n      buttons={[\n        { name: `confirm ${name}`, image: confirm, callback: onConfirm },\n        { name: `cancel ${name}`, image: cancel, callback: onCancel },\n      ]}\n    />\n  );\n}\n\nConfirmControls.propTypes = {\n  onConfirm: func.isRequired,\n  onCancel: func.isRequired,\n};\n\nexport function AddControls({ onObject, onValue, onCancel }) {\n  return (\n    <Controls\n      operation={{\n        name: \"add\",\n        image: add,\n      }}\n      buttons={[\n        { name: \"section\", text: \"{}\", callback: onObject },\n        { name: \"value\", text: '\"\"', callback: onValue },\n        { name: \"cancel\", image: cancel, callback: onCancel },\n      ]}\n    />\n  );\n}\n\nAddControls.propTypes = {\n  onObject: func.isRequired,\n  onValue: func.isRequired,\n  onCancel: func.isRequired,\n};\n\nconst Container = styled.div`\n  cursor: default;\n`;\n\nconst Operation = styled.span`\n  font-size: 10px;\n  opacity: 0.8;\n`;\n","import { useEffect } from \"react\";\n\nexport const useEscapeKey = (onEscape) => {\n  useEffect(() => {\n    if (!onEscape) return;\n    const handleEsc = (event) => {\n      if (event.keyCode === 27) onEscape();\n    };\n    window.addEventListener(\"keydown\", handleEsc);\n\n    return () => {\n      window.removeEventListener(\"keydown\", handleEsc);\n    };\n  }, [onEscape]);\n};\n\nexport const getServerHost = () => {\n  const url = new URL(window.location.href);\n  const serverPort = url.searchParams.get(\"serverPort\") || url.port;\n  return `${url.hostname}:${serverPort}`;\n};\n","import { useEffect, useState } from \"react\";\nimport { func, bool, string } from \"prop-types\";\nimport { MainControls, ConfirmControls, AddControls } from \"./Controls\";\nimport { NodeType } from \"../../protocol\";\nimport { useEscapeKey } from \"../util\";\n\nexport const ConfirmationModes = {\n  remove: \"REMOVE_MODE\",\n  edit: \"EDIT_MODE\",\n  add: \"ADD_MODE\",\n};\n\nexport const ControlsContainer = ({\n  editing,\n  visible,\n  onAdd,\n  onRemove,\n  onConfirmEdit,\n  onCancelEdit,\n  onBeginEdit,\n  copyString,\n}) => {\n  const [mode, setMode] = useState(\n    editing ? ConfirmationModes.edit : undefined\n  );\n  useEffect(() => {\n    setMode(editing ? ConfirmationModes.edit : undefined);\n  }, [editing]);\n\n  const withResetMode = (fn, ...args) => () => {\n    setMode(undefined);\n    fn?.(...args);\n  };\n\n  useEscapeKey(\n    mode &&\n      withResetMode(mode === ConfirmationModes.edit ? onCancelEdit : undefined)\n  );\n\n  switch (mode) {\n    case ConfirmationModes.add:\n      return (\n        <AddControls\n          onObject={withResetMode(onAdd, NodeType.OBJECT)}\n          onValue={withResetMode(onAdd, NodeType.VALUE)}\n          onCancel={withResetMode()}\n        />\n      );\n    case ConfirmationModes.remove:\n    case ConfirmationModes.edit:\n      return (\n        <ConfirmControls\n          editMode={mode === ConfirmationModes.edit}\n          onConfirm={withResetMode(\n            mode === ConfirmationModes.edit ? onConfirmEdit : onRemove\n          )}\n          onCancel={withResetMode(\n            mode === ConfirmationModes.edit ? onCancelEdit : undefined\n          )}\n        />\n      );\n    default:\n      return (\n        <MainControls\n          visible={visible}\n          copyString={copyString}\n          onAdd={onAdd && (() => setMode(ConfirmationModes.add))}\n          onRemove={onRemove && (() => setMode(ConfirmationModes.remove))}\n          onEdit={\n            onConfirmEdit &&\n            (() => {\n              setMode(ConfirmationModes.edit);\n              onBeginEdit?.();\n            })\n          }\n        />\n      );\n  }\n};\n\nControlsContainer.propTypes = {\n  editing: bool,\n  visible: bool,\n  onAdd: func,\n  onRemove: func,\n  onConfirmEdit: func,\n  onCancelEdit: func,\n  onBeginEdit: func,\n  copyString: string,\n};\n\nControlsContainer.defaultProps = {\n  onBeginEdit: () => {},\n};\n\nexport default ControlsContainer;\n","import React from \"react\";\nimport { googleTranslate } from \"../images\";\nimport { Button } from \"./Button\";\n\nexport function TranslateButton({ text, fromLanguage, toLanguage, onResult }) {\n  const title = 'Open on GoogleTranslate';\n  return (\n    <a\n      href={`https://translate.google.com/?sl=${encodeURIComponent(\n        fromLanguage\n      )}&tl=${encodeURIComponent(toLanguage)}&text=${encodeURIComponent(text)}`}\n      target=\"_blank\"\n      rel=\"noreferrer\"\n    >\n      <Button title={title}>\n        <img src={googleTranslate} width=\"12\" alt={title} />\n      </Button>\n    </a>\n  );\n}\n","import { useState, useContext, useEffect, useCallback } from \"react\";\nimport ControlsContainer from \"./components/ControlsContainer\";\nimport styled from \"styled-components\";\nimport { TreeContext } from \"./Context\";\nimport { useEscapeKey } from \"./util\";\nimport { TranslateButton } from \"./components/TranslateButton\";\nimport { Problem, extractPlaceholders } from \"./problem\";\nimport { isEqual } from \"lodash\";\n\nfunction Value({\n  language,\n  editing,\n  value,\n  onChange,\n  onEdit,\n  hint,\n  highlight,\n}) {\n  const [autoFocus, setAutoFocus] = useState(false);\n  const [focused, setFocused] = useState(false);\n  const [inputWidth, setInputWidth] = useState();\n  useEffect(() => {\n    if (!editing) {\n      setAutoFocus(false);\n      setFocused(false);\n    }\n  }, [editing]);\n\n  const cancelEdit = useCallback(() => onEdit(false), [onEdit]);\n  useEscapeKey(editing && cancelEdit);\n\n  return (\n    <ValueContainer value={value}>\n      <LanguageTag>{language}</LanguageTag>\n      {editing ? (\n        <>\n          <ValueEditor\n            style={{ width: inputWidth }}\n            onFocus={() => setFocused(true)}\n            autoFocus={autoFocus}\n            value={value || \"\"}\n            onChange={(event) => onChange(event.target.value)}\n          />\n          {focused && hint ? (\n            <TranslateButton\n              text={hint.value}\n              fromLanguage={hint.language}\n              toLanguage={language}\n            />\n          ) : null}\n        </>\n      ) : (\n        <ValueWrapper\n          value={value}\n          highlight={highlight}\n          title={\n            highlight ||\n            (value !== null &&\n              value !== undefined &&\n              !value?.trim() &&\n              \"\\u26A0 Potential issue: Empty value\")\n          }\n          onDoubleClick={() => {\n            setAutoFocus(true);\n            onEdit(true);\n          }}\n          ref={(elem) => {\n            if (elem) setInputWidth(elem.offsetWidth);\n          }}\n        >\n          {value?.trim()\n            ? value\n            : value === null || value === undefined\n            ? \"<missing>\"\n            : `\"${value}\"`}\n        </ValueWrapper>\n      )}\n    </ValueContainer>\n  );\n}\n\nexport function ValueNode({ node }) {\n  const [showControls, setShowControls] = useState(false);\n  const [editing, setEditing] = useState(false);\n  const [values, setValues] = useState(node.values);\n  const {\n    languages,\n    onChangeValue,\n    onRemove,\n    problematicTranslations,\n    disabled,\n  } = useContext(TreeContext);\n\n  const onCancelEdit = useCallback(() => {\n    setValues(node.values);\n    setEditing(false);\n  }, [node]);\n\n  useEffect(() => {\n    if (disabled) {\n      onCancelEdit();\n    }\n  }, [disabled, onCancelEdit]);\n\n  const problem = problematicTranslations.find(({ id }) => id === node.id)\n    ?.problem;\n\n  return (\n    <Container\n      onMouseEnter={() => setShowControls(true)}\n      onMouseLeave={() => setShowControls(false)}\n    >\n      <Label title={node.id} problem={problem}>\n        {node.name}\n      </Label>\n      <ValuesContainer>\n        {languages.map((language) => {\n          const value = values[language];\n          const hintLanguage = Object.keys(values).find(\n            (l) => l !== language && values[l]\n          );\n          const highlightLanguage =\n            (problem === Problem.SAME &&\n              Object.keys(values).find(\n                (l) => l !== language && values[l] === value\n              )) ||\n            (problem === Problem.PLACEHOLDER_MISMATCH &&\n              Object.keys(values).find(\n                (l) =>\n                  l !== language &&\n                  !isEqual(\n                    extractPlaceholders(values[l]),\n                    extractPlaceholders(value)\n                  )\n              ));\n\n          const highlight =\n            highlightLanguage &&\n            (problem === Problem.SAME\n              ? `\\u26A0 Potential issue: The same as the \"${highlightLanguage}\" version`\n              : `\\u26A0 Potential issue: Different placeholders from the \"${highlightLanguage}\" version`);\n          return (\n            <Value\n              key={language}\n              language={language}\n              editing={editing}\n              hint={\n                hintLanguage && {\n                  language: hintLanguage,\n                  value: values[hintLanguage],\n                }\n              }\n              value={value}\n              highlight={highlight}\n              onChange={(v) => setValues({ ...values, [language]: v })}\n              onEdit={(v) => {\n                setEditing(!disabled && v);\n                if (!v) {\n                  setValues(node.values);\n                }\n              }}\n            />\n          );\n        })}\n      </ValuesContainer>\n      <ControlsContainer\n        visible={showControls}\n        editing={editing}\n        onBeginEdit={!disabled && (() => setEditing(true))}\n        onConfirmEdit={\n          !disabled &&\n          (() => {\n            languages.forEach((language) => {\n              const newValue = values[language];\n              const oldValue = node.values[language];\n              if (newValue !== oldValue) {\n                onChangeValue(node.id, language, newValue);\n              }\n            });\n            setEditing(false);\n          })\n        }\n        onCancelEdit={!disabled && onCancelEdit}\n        onRemove={\n          !disabled &&\n          (() => {\n            onRemove(node.id);\n          })\n        }\n        copyString={node.id}\n      />\n    </Container>\n  );\n}\n\nconst Container = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 2px;\n`;\n\nconst Label = styled.div`\n  cursor: default;\n  background-color: ${({ problem }) =>\n    problem === Problem.MISSING\n      ? \"salmon\"\n      : problem === Problem.EMPTY\n      ? \"moccasin\"\n      : problem\n      ? \"lightcyan\"\n      : \"lightgreen\"};\n  font-family: monospace, monospace;\n  padding: 0 8px;\n  border: 0.5px solid black;\n  border-radius: 4px 0 0 4px;\n  display: flex;\n  align-items: center;\n  align-self: stretch;\n`;\n\nconst ValuesContainer = styled.div``;\n\nconst LanguageTag = styled.span`\n  cursor: default;\n  padding: 0 8px;\n  color: white;\n  background-color: black;\n`;\n\nconst ValueContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  font-family: monospace, monospace;\n`;\n\nconst ValueWrapper = styled.div`\n  padding: 0 8px;\n  border: 0.5px solid black;\n  ${({ value, highlight }) =>\n    value === undefined || value === null\n      ? \"background-color: red; color: white; font-style: italic; font-family: sans-serif, monospace;\"\n      : !value.trim()\n      ? \"background-color: orange;\"\n      : highlight\n      ? \"background-color: lightcyan;\"\n      : \"\"}\n`;\n\nconst ValueEditor = styled.textarea`\n  font-size: 16px;\n`;\n","import { useState, useContext, useCallback, useEffect } from \"react\";\nimport SmoothCollapse from \"react-smooth-collapse\";\nimport ControlsContainer from \"./components/ControlsContainer\";\nimport styled from \"styled-components\";\nimport { TreeContext } from \"./Context\";\nimport { NodeType } from \"../protocol\";\nimport { ValueNode } from \"./ValueNode\";\nimport { confirm, cancel } from \"./images\";\nimport { Button } from \"./components/Button\";\nimport { useEscapeKey } from \"./util\";\nimport { Problem } from \"./problem\";\n\nexport function ObjectNode({ node }) {\n  const [expanded, setExpanded] = useState(!node.id);\n  const [showControls, setShowControls] = useState(false);\n  const [adding, setAdding] = useState();\n  const [addingLabel, setAddingLabel] = useState(\"\");\n  const { onAdd, onRemove, problematicTranslations, disabled } = useContext(\n    TreeContext\n  );\n\n  const stopAdding = useCallback(() => {\n    setAdding(undefined);\n    setAddingLabel(\"\");\n  }, []);\n\n  useEffect(() => {\n    if (!expanded || disabled) {\n      stopAdding();\n    }\n  }, [disabled, expanded, stopAdding]);\n\n  useEscapeKey(adding && stopAdding);\n\n  const problems = problematicTranslations\n    .filter(({ id }) => id.startsWith(node.id))\n    .map(({ problem }) => problem);\n  const problem = problems.includes(Problem.MISSING)\n    ? Problem.MISSING\n    : problems.includes(Problem.EMPTY)\n    ? Problem.EMPTY\n    : problems.includes(Problem.SAME)\n    ? Problem.SAME\n    : undefined;\n\n  const addingValid =\n    addingLabel &&\n    /^\\w+$/.test(addingLabel) &&\n    !node.children.some(({ name }) => name === addingLabel);\n\n  const onConfirmAdd = addingValid\n    ? () => {\n        onAdd(node.id, adding, addingLabel);\n        stopAdding();\n      }\n    : undefined;\n\n  return (\n    <>\n      <NodeContainer\n        onClick={() => setExpanded((c) => !c)}\n        onMouseEnter={() => setShowControls(true)}\n        onMouseLeave={() => setShowControls(false)}\n      >\n        <Label\n          id={node.id}\n          problem={problem}\n          expanded={expanded}\n          title={node.id}\n        >\n          <Caret>{expanded ? \"-\" : \"+\"}</Caret>\n          {node.name}\n        </Label>\n        {expanded ? (\n          !adding &&\n          !disabled && (\n            <ControlsContainer\n              visible={showControls}\n              onAdd={(type) => setAdding(type)}\n              onRemove={node.id && (() => onRemove(node.id))}\n            />\n          )\n        ) : (\n          <Collapsed>{`{} ${node.children.length} item${\n            node.children.length === 1 ? \"\" : \"s\"\n          }`}</Collapsed>\n        )}\n      </NodeContainer>\n      {adding ? (\n        <>\n          <NewItemInput\n            type=\"text\"\n            autoFocus\n            placeholder={\n              adding === NodeType.OBJECT ? \"new section\" : \"new value\"\n            }\n            onChange={(event) => setAddingLabel(event.target.value.trim())}\n            onKeyPress={(e) => e.key === \"Enter\" && onConfirmAdd?.()}\n          />\n          {addingValid ? (\n            <Button onClick={onConfirmAdd}>\n              <img src={confirm} width=\"16\" alt=\"confirm\" />\n            </Button>\n          ) : null}\n          <Button onClick={stopAdding}>\n            <img src={cancel} width=\"16\" alt=\"cancel\" />\n          </Button>\n        </>\n      ) : null}\n      <SubTree>\n        <SmoothCollapse expanded={expanded}>\n          {node.children.map((n) =>\n            n.type === NodeType.OBJECT ? (\n              <ObjectNode key={n.id} node={n} />\n            ) : (\n              <ValueNode key={n.id} node={n} />\n            )\n          )}\n        </SmoothCollapse>\n      </SubTree>\n    </>\n  );\n}\n\nconst getLabelBackground = ({ id, problem, expanded }) => {\n  if (!id) return \"white\";\n  switch (problem) {\n    case Problem.MISSING:\n      return expanded ? \"pink\" : \"salmon\";\n    case Problem.EMPTY:\n      return expanded ? \"white\" : \"moccasin\";\n    case Problem.SAME:\n      return expanded ? \"white\" : \"lightcyan\";\n    default:\n      return expanded ? \"mintcream\" : \"lightgreen\";\n  }\n};\n\nconst NodeContainer = styled.div`\n  cursor: default;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n`;\n\nconst Caret = styled.span`\n  min-width: 10px;\n  margin-right: 2px;\n`;\n\nconst Label = styled.span`\n  background-color: ${getLabelBackground};\n  font-family: monospace, monospace;\n  padding: 0 8px;\n  border: 0.5px solid black;\n  border-radius: 4px;\n\n  &:hover {\n    font-weight: bold;\n  }\n`;\n\nconst Collapsed = styled.span`\n  color: grey;\n  margin: 0 8px;\n`;\n\nconst SubTree = styled.div`\n  padding-left: 20px;\n  margin-bottom: 4px;\n`;\n\nconst NewItemInput = styled.input`\n  font-family: monospace, monospace;\n  font-size: 16px;\n  padding: 0 8px;\n  margin-left: 20px;\n  margin-bottom: 4px;\n`;\n","import { useEffect, useState } from \"react\";\nimport { Action } from \"../protocol\";\nimport { findProblems } from \"./problem\";\nimport { TreeContext } from \"./Context\";\nimport { ObjectNode } from \"./ObjectNode\";\n\nexport default function Tree({ data, onSendMessage, disabled }) {\n  const [root, setRoot] = useState(data);\n  useEffect(() => {\n    setRoot(data);\n  }, [data]);\n\n  const [problematicTranslations, setProblematicTranslations] = useState([]);\n  useEffect(() => {\n    if (root?.languages?.length) {\n      setProblematicTranslations(findProblems(root.content, root.languages));\n    }\n  }, [root]);\n\n  return (\n    <TreeContext.Provider\n      value={{\n        disabled,\n        problematicTranslations,\n        languages: root?.languages,\n        onAdd: (id, type, label) => onSendMessage(Action.add(id, type, label)),\n        onChangeValue: (id, language, value) =>\n          onSendMessage(Action.changeValue(id, language, value)),\n        onRemove: (id) => onSendMessage(Action.remove(id)),\n      }}\n    >\n      {root ? <ObjectNode node={root.content} /> : null}\n    </TreeContext.Provider>\n  );\n}\n","import Footer from \"./Footer\";\nimport useWebSocket, { ReadyState } from \"react-use-websocket\";\nimport { useCallback, useEffect, useState } from \"react\";\nimport Tree from \"./tree/Tree\";\nimport styled from \"styled-components\";\nimport { ActionType } from \"./protocol\";\nimport { getServerHost } from \"./tree/util\";\n\nexport default function App() {\n  const serverHost = getServerHost();\n\n  const [data, setData] = useState();\n  const handleIncomingMessage = useCallback((action) => {\n    switch (action.action) {\n      case ActionType.DATA_UPDATE:\n        setData(action.data);\n        break;\n      default:\n        console.error(\"Invalid action:\", action.action);\n        break;\n    }\n  }, []);\n\n  const { sendMessage, readyState } = useWebSocket(`ws://${serverHost}`, {\n    retryOnError: true,\n    shouldReconnect: () => true,\n    reconnectAttempts: 100,\n    onMessage: (ev) => handleIncomingMessage(JSON.parse(ev.data)),\n  });\n\n  const getStatusLabel = useCallback(() => {\n    switch (readyState) {\n      case ReadyState.OPEN:\n        return \"Connected\";\n      case ReadyState.CONNECTING:\n        return \"Connecting\";\n      case ReadyState.CLOSED:\n        return \"Server not reachable\";\n      default:\n        return \"Unknown\";\n    }\n  }, [readyState]);\n\n  const onSendMessage = useCallback(\n    (message) => {\n      sendMessage(JSON.stringify(message));\n    },\n    [sendMessage]\n  );\n\n  useEffect(() => {\n    if (readyState === ReadyState.OPEN) {\n      fetch(`http://${serverHost}/data`)\n        .then((response) => response.json())\n        .then(setData);\n    }\n  }, [readyState, serverHost]);\n\n  return (\n    <AppContainer>\n      <ConnectionStatus status={readyState}>\n        {getStatusLabel()}\n      </ConnectionStatus>\n      <Content>\n        {!data && \"No data\"}\n        <Tree\n          data={data}\n          onSendMessage={onSendMessage}\n          disabled={readyState !== ReadyState.OPEN}\n        />\n      </Content>\n\n      <Footer />\n    </AppContainer>\n  );\n}\n\nconst AppContainer = styled.div`\n  background-color: #ffffff;\n  display: flex;\n  flex-direction: column;\n  min-height: 100vh;\n\n  font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", \"Roboto\", \"Oxygen\",\n    \"Ubuntu\", \"Cantarell\", \"Fira Sans\", \"Droid Sans\", \"Helvetica Neue\",\n    sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  font-weight: 400;\n`;\n\nconst Content = styled.div`\n  flex: 1;\n  min-width: 800px;\n  max-width: 95vw;\n  margin: 0 40px;\n  padding-top: 15px;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst ConnectionStatus = styled.div`\n  color: ${({ status }) =>\n    status === ReadyState.OPEN\n      ? \"darkgreen\"\n      : status === ReadyState.CONNECTING\n      ? \"black\"\n      : \"darkred\"};\n`;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}